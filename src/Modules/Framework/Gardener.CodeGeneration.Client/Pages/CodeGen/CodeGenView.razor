@page "/system_tool/code_gen"
@inherits ListTableBase<CodeGenDto, int, CodeGenEdit>

<div>
    <Table @ref="_table"
           TItem="CodeGenDto"
           DataSource="@_datas"
           Total="_total"
           OnChange="@OnChange"
           @bind-PageIndex="_pageIndex"
           @bind-PageSize="_pageSize"
           @bind-SelectedRows="_selectedRows"
           Loading="@_tableIsLoading"
           Context="model"
           RemoteDataSource>
        <TitleTemplate>
            <TableSearch TDto="CodeGenSearchDto" OnSearchFieldChanged="SetPresetFilterGroups" OnSearch="DoSearch" DefaultValue="_defaultSearchValue"></TableSearch>
            @*Custom Search*@
            <Row>
                <AntDesign.Col Span="24">
                    <Space>
                        <SpaceItem>
                            <span>@localizer["表名"]: </span>
                            <Select Mode="multiple"
                                    DataSource="@_select_TableName"
                                    @bind-Values="@_searchDto.TableName"
                                    ValueName="@nameof(SelectItem.ValueName)"
                                    LabelName="@nameof(SelectItem.LabelName)"
                                    TItem="SelectItem"
                                    TItemValue="string"
                                    EnableSearch
                                    AllowClear
                                    Style="width:200px">
                            </Select>
                        </SpaceItem>
                        <SpaceItem>
                            <span>@localizer["类名"]: </span>
                            <Input Style="@searchInputStyle" Type="text" TValue="string" OnPressEnter="DoSearch"
                            @bind-Value="@_searchDto.ClassName"></Input>
                        </SpaceItem>
                    </Space>
                </AntDesign.Col>
                @*<AntDesign.Col Span="2">
                    <Button Icon="search" Shape="@ButtonShape.Round" OnClick="DoSearch">
                        @localizer["Search"]
                    </Button>
                    <Button Icon="sync" Type="@ButtonType.Dashed" OnClick="DoClearSearch">
                        @localizer["Clear"]
                    </Button>
                </AntDesign.Col>*@
            </Row>
            <Row>
                <AntDesign.Col Span="8">
                    <Button Type="@ButtonType.Primary" Icon="delete" Danger OnClick="OnClickDeletes" Loading="_deletesBtnLoading">
                        @localizer["删除选中"]
                    </Button>
                    <Button Type="@ButtonType.Primary" OnClick="OnClickGenerates" Loading="_generatesBtnLoading">
                        @localizer["批量生成"]
                    </Button>
                </AntDesign.Col>
                <AntDesign.Col Span="16" Style="text-align:right">
                    <Space>
                        <SpaceItem>
                            <Button Type="@ButtonType.Primary" Icon="plus" OnClick="OnClickAdd">
                                @localizer["添加"]
                            </Button>
                        </SpaceItem>
                        <SpaceItem>
                            <Button Type="@ButtonType.Primary" Icon="reload" OnClick="ReLoadTable">
                                @localizer["刷新"]
                            </Button>
                        </SpaceItem>

                        <SpaceItem>
                            <Button Type="@ButtonType.Primary" Icon="folder" OnClick="OpenCodeGenFolder">
                                @localizer["打开代码目录"]
                            </Button>
                        </SpaceItem>

                        <SpaceItem>
                            <Button Type="@ButtonType.Primary" Icon="download" OnClick="OnClickShowSeedData">
                                @localizer["种子数据"]
                            </Button>
                        </SpaceItem>
                        <SpaceItem>
                            <Button Type="@ButtonType.Primary" Icon="download" OnClick="OnDownloadConfigSeedDataClick">
                                @(localizer.Combination("配置","种子数据"))
                            </Button>
                        </SpaceItem>
                    </Space>
                </AntDesign.Col>
            </Row>

        </TitleTemplate>
        <RowTemplate>
            <Selection Key="@(model.Id.ToString())" />
            <Column @bind-Field="@model.TableName" Title="@(localizer["表名"])" Sortable Filterable />
            <Column @bind-Field="@model.ClassName" Title="@(localizer["类名"])" Sortable Filterable />
            <Column @bind-Field="@model.Module" Title="@(localizer["模块"])" Sortable Filterable />
            <Column @bind-Field="@model.Remark" Title="@(localizer["备注"])" Sortable Filterable></Column>
            <Column @bind-Field="@model.MenuNameEN" Title="@(localizer.Combination("菜单名称","(","英文",")"))" Sortable Filterable />
            <Column @bind-Field="@model.MenuNameCH" Title="@(localizer.Combination("菜单名称","(","中文",")"))" Sortable Filterable />
            <Column @bind-Field="@model.TableDescriptionEN" Title="@(localizer.Combination("表描述","(","英文",")"))" Sortable Filterable />
            <Column @bind-Field="@model.TableDescriptionCH" Title="@(localizer.Combination("表描述","(","中文",")"))" Sortable Filterable />
            <Column @bind-Field="@model.CreatedTime" Title="@(localizer["创建时间"])" Format="@ClientConstant.DateTimeFormat" Sortable DefaultSortOrder="@SortDirection.Descending" />
            <ActionColumn Title="@localizer["操作"]" Fixed="right">
                <Space>
                    <SpaceItem>
                        <Button Type="@ButtonType.Link" OnClick="()=>OnClickEdit(model.Id)">
                            @localizer["编辑"]
                        </Button>
                    </SpaceItem>
                    <SpaceItem>
                        <Button Type="@ButtonType.Link" OnClick="()=>OnClickConfigure(model.Id)">
                            @localizer["设置"]
                        </Button>
                    </SpaceItem>

                    <SpaceItem>
                        <Button Type="@ButtonType.Link" OnClick="()=>OnClickGenerateMenu(model.Id)">
                            @localizer["生成菜单"]
                        </Button>
                    </SpaceItem>

                    <SpaceItem>
                        <Button Type="@ButtonType.Link" OnClick="()=>OnClickGenerate(model.Id)">
                            @localizer["生成"]
                        </Button>
                    </SpaceItem>

                    <SpaceItem>
                        <Button Type="@ButtonType.Link" Danger OnClick="()=>OnClickTrueDelete(model.Id)">
                            @localizer["删除"]
                        </Button>
                    </SpaceItem>
                </Space>
            </ActionColumn>
        </RowTemplate>
    </Table>
</div>
